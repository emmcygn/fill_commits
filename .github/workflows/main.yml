# .github/workflows/main.yml

on:
  workflow_dispatch:
  schedule:
    - cron: '0 2 * * *'  # Run daily at 2 AM UTC
  push:

jobs:
  backfill-weekdays:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
    - name: Backfill weekday commits
      uses: bcanseco/github-contribution-graph-action@v2
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        GIT_EMAIL: emmanuelcuyugan@gmail.com
        MAX_DAYS: 365
        MIN_COMMITS_PER_DAY: 1
        MAX_COMMITS_PER_DAY: 5
        INCLUDE_WEEKENDS: false
        INCLUDE_WEEKDAYS: true
        GIT_COMMIT_MESSAGE: "chore: weekday contribution"
    
  backfill-weekends:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
    - name: Backfill weekend commits
      uses: bcanseco/github-contribution-graph-action@v2
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        GIT_EMAIL: emmanuelcuyugan@gmail.com
        MAX_DAYS: 365
        MIN_COMMITS_PER_DAY: 0
        MAX_COMMITS_PER_DAY: 2
        INCLUDE_WEEKENDS: true
        INCLUDE_WEEKDAYS: false
        GIT_COMMIT_MESSAGE: "chore: weekend contribution"
    
  verify-commits:
    needs: [backfill-weekdays, backfill-weekends]
    runs-on: ubuntu-latest
    steps:
    - name: Verify commits
      run: |
        echo "Checking recent commits..."
        git log --oneline --since="1 day ago" | wc -l
        echo "Weekday and weekend backfill completed successfully!"      
